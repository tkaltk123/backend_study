# 1장 JPA 소개
## [전체 JPA 문서](index.md)
> 2022 상반기 JPA 스터디 정리용 문서

## 1.1 SQL과 문제점 
- 기존의 경우 자바 애플리케이션에서는 JDBC API를 통해 SQL을 RDB에 전달한다.
### 1.1.1 불필요한 반복적인 코드
- 하지만 SQL을 직접 다루게 될 경우 SQL을 작성하고, JDBC API를 호출하고, 결과를 객체로 매핑하는 등의 비슷한 작업을 관리할 모든 테이블에서 작성하게된다.
### 1.1.2 SQL에 의존적인 개발
- 또한 비즈니스 요구사항을 모델링한 객체를 엔티티라 하는데, SQL을 직접 다루게 될 경우 쿼리 결과와 엔티티의 매핑은 DAO에서 SQL을 사용해 이루어 지기 때문에 엔티티와 실행되는 SQL은 아주 강한 의존관계를 가지고 있다.
- 때문에 요구사항이 변경될 경우 엔티티와 DAO를 모두 수정해야하고, 엔티티에서 문제가 발생하면 DAO에서 호출되는 SQL을 확인해야만 문제를 해결할 수 있기 때문에 엔티티를 신뢰할 수 없다.
## 1.2 패러다임의 불일치 
- 현대의 애플리케이션은 대부분 복잡도를 관리하기 위해 객체지향 언어로 개발된다.
- 하지만 관계형 데이터베이스는 데이터 중심 구조로 상속이나 다형성 같은 객체지향의 개념이 존재하지 않는다.
- 그렇기 때문에 객체지향 언어로 개발하고 관계형 데이터베이스에 데이터를 저장하게 된다면 데이터를 읽고 저장하는 과정에서 발생하는 불일치를 개발자가 지속적으로 관리해주어야 한다.
### 1.2.1 상속 
- 데이터베이스는 상속이 존재하지 않기 때문에 상속관계를 표현하기 위한 가장 유사한 방법으로 슈퍼-서브 타입 관계를 사용할 수 있다.
- 하지만 슈퍼타입을 위한 테이블을 새로 만들 경우 데이터를 추가하기 위해 두 테이블 모두에 INSERT를 해야하고, 데이터를 읽기 위해서는 두 테이블을 JOIN해서 SELECT 해야한다.
### 1.2.2 연관관계 
- 또한 객체는 연관관계를 가지고 있는 객체를 참조를 이용해 조회할 수 있지만, 테이블은 외래 키를 사용해 연관관계를 표현하고 JOIN을 사용해 연관된 테이블을 조회한다. 외래키로 표현된 연관관계를 참조를 이용한 객체지향 모델링으로 변환하는것은 매우 어렵다.
- 외래키를 직접 클래스의 필드로 사용할 경우 객체를 테이블에 저장하거나 조회할 때에는 편리하지만 연관된 객체를 참조할 수 없다.
- 연관된 객체의 참조를 필드로 사용할 경우 연관된 객체의 속성에 접근할 수 있지만 참조 형태로 표현하기 위한 변환작업을 개발자가 직접 해주어야 한다.
### 1.2.3 객체 그래프 탐색 
- 객체는 다른 객체들과 연관관계를 맺고 있고 연관된 객체들을 자유롭게 탐색할 수 있어야 한다. 하지만 SQL을 직접 다룰 경우 처음 실행하는 SQL의 조인 범위에 따라 객체의 탐색 범위가 고정된다.
### 1.2.4 비교 
- 객체의 비교에는 객체의 주소값을 비교하는 동일성 비교와 객체 내부의 값들을 비교하는 동등성 비교가 있다.
- 객체의 동일성까지 보장하기 위해서는 같은 행을 조회했을 때 같은 객체를 반환하도록 구현해야 한다.
### 1.2.5 정리 
- 객체지향적인 애플리케이션과 데이터베이스의 구조는 자향하는 패러다임이 서로 다르다.
- 때문에 이 불일치를 해결하기 위해 개발자의 자원을 소모하게 되고, 더욱 정교하게 객체 모델링을 할 수록 더 많은 비용을 소모하게 되면서 결국에는 객체 모델링을 포기하고 데이터 중심의 모델을 사용하게 된다.
## 1.3 JPA란 무엇일까? 
- JPA(Java Persistence API)란 자바 진영의 ORM 기술 표준으로 JDBC를 포함하고있다.
- ORM(Object-Relational Mapping)은 객체와 관계형 데이터베이스를 매핑하는 것을 의미한다.
### 1.3.1 JPA 소개 
- 과거 자바 진영에는 엔티티 빈이라는 ORM 기술이 존재했는데 엔티티 빈은 너무 복잡하고 완성도가 떨어졌으면 J2EE 환경에서만 동작했기 때문에 잘 사용되지 않았다.
- 이후 하이버네이트라는 오픈소스 ORM 프레임워크가 등장했는데 엔티티 빈과 비교해서 많은 장점을 가지고 있었기 때문에 많은 개발자가 사용하기 시작했다.
- 결국 하이버네이트를 기반으로 새로운 자바 ORM 표준이 만들어 졌는데 이것이 바로 JPA이다.
- 즉, JPA는 구현된 기능이 아닌 공통적인 인터페이스의 모음이다. JPA의 구현체로는 주로 하이버네이트가 사용된다.
### 1.3.2 왜 JPA를 사용해야 하는가? 
- 생산성
  - jpa를 사용하면 함수를 호출하듯이 데이터베이스에 접근할 수 있고 필요한 SQL은 JPA가 대신 생성해준다.
-  유지보수
   -  SQL을 직접 다룰 경우, 테이블에 속성 하나만 추가되어도 그 테이블과 관련된 삽입, 수정, 조회 SQL을 모두 수정해 주어야 하고 결과를 매핑하기 위한 JDBC API 코드 또한 모두 변경해야 한다.
   -  하지만 JPA를 사용하면 귀찮은 작업 없이 엔티티에 필드를 추가하는 것 만으로 끝나게 된다.
   -  또한 패러다임의 불일치를 해결해주므로 유지보수에 용이한 객체 모델링을 할 수 있다.
- 성능
  - JPA는 캐싱 기능을 지원하므로 직접 JDBC API를 호출하는 것 보다 최적화 할 기회가 많다.
- 추상화와 벤더 독립성
  - SQL을 직접 다룰 경우 데이터베이스가 변경되면 관련된 SQL도 모두 변경이 필요하다.
  - 하지만 JPA가 제공하는 추상화된 API를 사용할 경우 간단한 설정 변경만으로 쉽게 데이터베이스를 변경할 수 있다.
## 1.4 정리 

## [맨 위로](#)