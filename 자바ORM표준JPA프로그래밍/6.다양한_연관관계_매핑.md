# 6장 다양한 연관관계 매핑 
## [전체 JPA 문서](index.md)

## 6.1 다대일 
### 6.1.1 다대일 단방향 [N:1] 
- [5.1. 단방향 연관관계 참조](5.연관관계_매핑_기초.md#51-단방향-연관관계)
### 6.1.2 다대일 양방향 [N:1, 1:N] 
- [5.3. 양방향 연관관계 참조](5.연관관계_매핑_기초.md#53-양방향-연관관계)
## 6.2 일대다 
- 일대다 관계는 다대일 관계의 반대 방향으로 연관관계의 주인이 팀 엔티티이다.
### 6.2.1 일대다 단방향 [1:N] 
- 일대다 단방향 관계에서는 회원 테이블에 있는 외래키를 팀 엔티티에서 관리하고 팀 엔티티에서만 등록된 회원을 조회할 수 있다.
### 6.2.2 일대다 양방향 [1:N, N:1] 
- 일대다 양방향은 존재하지 않는다. 다대일 양방향 관계를 사용하자.
## 6.3 일대일 [1:1] 
- 일대일 관계는 양쪽이 서로 하나의 관계만 가진다.
- 일대일 관계는 그 반대도 일대일 관계다.
- 일대다 관계에서는 '다'쪽이 외래키를 가지지만 일대일 관계에서는 어느쪽이든 외래 키를 가질 수 있다.
### 6.3.1 주 테이블에 외래 키 
- 외래키를 객체 참조처럼 사용할 수 있어 객체지향 개발자들이 선호한다.
- 단방향
  - 주 엔티티에 `@OneToOne @JoinColumn`으로 매핑한다.
- 양방향
  - 단방향 + 대상 엔티티에 `@OneToOne(mappedBy="")`으로 매핑한다.
### 6.3.2 대상 테이블에 외래 키 
- 테이블 구조를 일대일에서 일대다로 변경할 때 유리하다.
- 대상 테이블에 외래키를 두는 방식은 단방향이 불가능하다.
- 양방향 관계는 6.3.1. 의 양방향 방식의 방향을 바꿔서 매핑한다.
## 6.4 다대다 [N:N] 
- 정규화된 RDB에서는 테이블 2개로 다대다 관계를 표현할 수 없어서 보통 다대일, 일대다 관계의 연결 테이블을 사용한다.
- 하지만 객체는 컬랙션을 사용해 두개의 객체로 다대다 관계를 표현이 가능하다.
### 6.4.1 다대다: 단방향 
- `@ManyToMany @JoinTable(name,joinColumns,inverseJoinColumns)`를 사용해 연결 테이블을 엔티티로 만들지 않고 바로 매핑한다.
### 6.4.2 다대다: 양방향 
- 연관관계의 주인을 6.4.1.의 방식으로 매핑하고 반대쪽은 `@ManyToMany(mappedBy)`로 매핑한다.
### 6.4.3 다대다: 매핑의 한계와 극복, 연결 엔티티 사용 
- `@ManyToMany`로 매핑하게 되면 연결 테이블에 외래키가 아닌 다른 속성을 사용할 수 없기 때문에 보통 연결 엔티티를 추가하고 이 연결 엔티티와 두개의 다대일 관계를 만드는 방식으로 매핑한다.
- 복합 기본 키
  - JPA에서 복합 키를 사용하려면 별도의 식별자 클래스를 만들고 `@IdClass`를 사용해 지정하면 된다.
  - 식별자 클래스는 다음과 같은 조건을 만족해야한다.
    - Serializeable을 구현해야 한다.
    - equals()와 hashCode()를 고현해야 한다.
    - 기본 생성자가 있어야 한다.
    - public 클래스여야 한다.
### 6.4.4 다대다: 새로운 기본 키 사용 
- 위와 같은 복합 기본 키를 사용한 매핑은 복잡하고 유연성이 떨어진다.
- 때문에 데이터베이스에서 자동으로 생성해주는 Long Type의 대리 키를 사용하면 복잡한 매핑 없이 간단히 사용할 수 있다.
## [실전 예제 3. 다양한 연관관계 매핑](실전_예제%203.%20다양한_연관관계_매핑.md)


## [맨 위로](#)